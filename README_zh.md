# 🎙️ 播客提取器

**中文 | [English](README.md)**

一个专业级的双语播客转录和总结平台，能够将播客音频转换为高质量的文本转录和AI智能总结。采用现代Web技术构建，**本地Faster-Whisper转录**，具备智能音频处理能力，确保最高性能和隐私保护。

## 🌟 项目概述

播客提取器是一个将音频内容转化为文本的全栈web应用，自动处理来自各大平台的播客节目，并以多种语言提供准确的转录和有意义的总结。

### 核心能力

- **🚀 本地Faster-Whisper转录**：超快本地语音转文字（8.4倍实时速度）
- **💾 文件下载支持**：自动保存转录文本和总结，支持下载功能
- **🔗 多平台支持**：支持Apple Podcasts、小宇宙、RSS订阅源和直接音频URL
- **🎵 智能音频处理**：直接处理大文件，无大小限制
- **🤖 AI智能优化**：无缝文本连续性优化和结构化总结
- **🔒 隐私优先**：本地转录处理，最小数据共享（仅文本总结使用外部AI）
- **🌍 双语界面**：原生中英文支持，动态语言切换
- **📱 响应式设计**：现代化移动优先UI，基于TailwindCSS构建

## 🏗️ 架构与实现

### 系统架构

```
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│      前端       │    │      后端        │    │    外部API      │
│                 │    │                  │    │                 │
│ • HTML5/CSS3    │◄──►│ • Express.js     │◄──►│ • OpenAI Whisper│
│ • 原生JS        │    │ • Node.js        │    │ • OpenAI GPT    │
│ • TailwindCSS   │    │ • 音频处理管道   │    │ • RSS订阅源     │
└─────────────────┘    └──────────────────┘    └─────────────────┘
                              │
                              ▼
                    ┌──────────────────┐
                    │    音频处理      │
                    │                  │
                    │ • FFmpeg         │
                    │ • 智能分割       │
                    │ • 并行任务       │
                    └──────────────────┘
```

### 核心处理流程

1. **播客链接解析**：多策略URL解析，支持不同平台
2. **音频提取**：直接下载结合RSS发现和API集成
3. **智能文件处理**：基于大小的处理策略，自动分割（10分钟片段）
4. **并发转录**：并行调用Whisper API，实现最优吞吐量
5. **文本优化**：AI驱动的连续性增强和流畅度改进
6. **智能总结**：结构化内容分析和要点提取

### 技术栈

#### 前端架构
- **HTML5**：语义化标记，具备无障碍功能
- **TailwindCSS**：实用优先的样式系统，自定义设计规范
- **原生JavaScript**：轻量级、无依赖的客户端逻辑
- **渐进式增强**：各种设备的优雅降级

#### 后端基础设施
- **Node.js**：异步、事件驱动的服务器运行时
- **Express.js**：简约的Web框架，支持中间件
- **FFmpeg集成**：系统级音频处理，专业级效果
- **并发处理**：基于Promise的并行任务执行

#### AI与机器学习集成
- **OpenAI Whisper**：最先进的语音转文字转录
- **GPT-4**：高级语言模型，用于总结和文本优化
- **定制提示**：专门的提示词，提升连续性和质量

## 📁 项目结构

```
podcast-to-text/
├── 📂 public/                          # 前端应用
│   ├── 📄 index.html                   # 主应用界面
│   └── 📄 script.js                    # 客户端逻辑和UI交互
│
├── 📂 server/                          # 后端服务
│   ├── 📄 index.js                     # Express服务器和API路由
│   ├── 📄 whisper_transcribe.py        # 本地Faster-Whisper转录脚本
│   ├── 📂 assets/                      # 测试资源
│   │   └── 📄 test_audio.mp3           # 测试音频样本
│   ├── 📂 services/                    # 核心业务逻辑
│   │   ├── 📄 openaiService.js         # AI处理和优化
│   │   ├── 📄 podcastService.js        # 播客提取和解析
│   │   ├── 📄 audioCompressionService.js # 音频处理管理
│   │   └── 📄 rssParser.js             # RSS订阅源处理
│   └── 📂 temp/                        # 临时音频和文本存储（自动创建）
│
├── 📄 package.json                     # 依赖和脚本
├── 📄 package-lock.json                # 依赖锁定文件
├── 📄 .env                            # 环境配置（从.env.example创建）
├── 📄 .gitignore                       # Git忽略规则
├── 📄 README.md                        # 英文文档
├── 📄 README_zh.md                     # 中文文档
├── 📄 PLATFORM_SUPPORT.md             # 平台兼容性指南
├── 📄 start.sh                        # 生产环境启动脚本
├── 📄 quick-start.sh                   # 快速设置脚本
└── 📄 fix-cursor-terminal.md           # IDE故障排除指南
```

## 🚀 快速开始

### 环境要求

- **Node.js 16+**：运行时环境
- **FFmpeg**：系统级音频处理（macOS用户：`brew install ffmpeg`）
- **OpenAI API密钥**：用于转录和总结服务

### 安装步骤

```bash
# 克隆仓库
git clone <repository-url>
cd podcast-to-text

# 安装依赖
npm install

# 配置环境
cp .env.example .env
# 编辑.env文件，添加你的OpenAI API密钥

# 启动应用
npm start
# 或开发模式（自动重载）
npm run dev
```

### 配置说明

创建`.env`文件，包含以下变量：

```env
# OpenAI 配置
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_BASE_URL=https://api.openai.com/v1

# 服务器配置
PORT=3000

# 可选：自定义音频处理限制
MAX_SEGMENT_SIZE_MB=25
SEGMENT_DURATION_SECONDS=600
```

## 🔧 高级特性

### 智能音频处理

- **大小检测**：自动文件大小分析，智能处理决策
- **分割策略**：使用FFmpeg的`-segment_time 600 -c copy`进行10分钟快速、无损分割
- **并发转录**：对每个音频片段并行调用Whisper API
- **错误恢复**：单个片段失败处理，支持部分结果恢复

### AI文本优化

- **连续性增强**：转录片段间的无缝连接
- **语言保持**：保持原说话者的风格和表达模式
- **语气词清理**：智能移除多余的语气词，同时保留语义
- **结构化总结**：分层内容组织，关键点提取

### 多平台支持

- **Apple Podcasts**：RSS订阅源发现和iTunes API集成
- **小宇宙**：原生API支持，RSS解析备用
- **通用RSS**：通用播客订阅源兼容性
- **直接音频**：支持MP3、M4A、WAV、AAC等格式

## 📡 API参考

### 核心接口

#### `POST /api/process-podcast`

处理播客转录和总结。

**请求体：**
```json
{
  "url": "https://podcasts.apple.com/us/podcast/...",
  "operation": "transcribe_and_summarize", // 或 "transcribe_only"
  "audioLanguage": "auto", // 或具体语言代码
  "outputLanguage": "zh" // 输出语言偏好
}
```

**响应：**
```json
{
  "success": true,
  "data": {
    "transcript": "优化后的转录文本...",
    "summary": "AI生成的总结...", // 仅在transcribe_and_summarize模式下
    "language": "zh",
    "processingInfo": {
      "segmentCount": 3,
      "totalDuration": "30:45"
    }
  }
}
```

#### `GET /api/health`

系统健康检查和状态信息。

## 🎯 性能与优化

### 处理效率

- **并行转录**：多个音频片段同时处理
- **内存管理**：高效的临时文件处理和自动清理
- **请求优化**：智能批处理和错误恢复
- **缓存策略**：部分失败的临时结果存储

### 可扩展性考虑

- **无状态设计**：每个请求独立且可扩展
- **资源管理**：自动清理防止存储积累
- **错误边界**：各组件独立的故障处理
- **速率限制**：内置防护，防止API滥用

## 🛠️ 开发

### 本地开发环境

```bash
# 安装开发依赖
npm install

# 启动开发服务器（热重载）
npm run dev

# 访问应用
open http://localhost:3000
```

### 贡献指南

1. **代码风格**：遵循ESLint配置
2. **测试**：为新功能添加测试
3. **文档**：重大变更需更新README
4. **错误处理**：实现完整的错误恢复

## 📋 平台兼容性

- **操作系统**：macOS、Linux、Windows（需安装FFmpeg）
- **浏览器**：Chrome 90+、Firefox 88+、Safari 14+、Edge 90+
- **Node.js**：16.x及更高版本
- **依赖**：最小外部依赖，便于部署

## 🔒 安全与隐私

- **无数据持久化**：音频文件处理后立即删除
- **安全API处理**：敏感密钥的环境变量保护
- **输入验证**：全面的URL和参数消毒
- **错误信息**：消毒后的错误消息，防止信息泄露

## 🌐 使用场景

### 个人用户
- **学习笔记**：将教育播客转为文字便于复习
- **内容整理**：为收藏的播客创建摘要索引
- **多语言学习**：获取不同语言的转录练习

### 专业用户
- **内容创作**：播客转录用于博客和文章创作
- **研究分析**：学术播客的文本分析和引用
- **无障碍支持**：为听力障碍用户提供文字版本

### 企业应用
- **会议记录**：企业播客和录音的自动转录
- **内容营销**：播客内容的文字版本SEO优化
- **知识管理**：将音频内容整合到企业知识库

## 📊 处理能力

### 支持的音频长度
- **小文件（≤25MB）**：直接处理，快速响应
- **中等文件（25-100MB）**：自动分割，并行处理
- **大文件（>100MB）**：智能分段，高效处理

### 处理时间估算
- **10分钟音频**：约2-3分钟处理时间
- **60分钟音频**：约10-15分钟处理时间
- **具体时间**：取决于网络速度和API响应时间

## 📄 许可证

MIT许可证 - 详见[LICENSE](LICENSE)文件。

## 🤝 参与贡献

欢迎贡献代码！请随时提交问题、功能请求或拉取请求。

### 开发路线图

- [ ] **多人协作**：支持团队工作空间
- [ ] **批量处理**：一次处理多个播客
- [ ] **本地部署**：Docker容器化部署方案
- [ ] **插件系统**：支持自定义处理插件

---

**为全球播客社区用❤️构建**
